{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Institution Profile</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.7.1/dist/cdn.min.js" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Arial, sans-serif; /* Default font */
        }
        .form-container {
            background-image: linear-gradient(135deg, #e0f2fe, #bae6fd);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
        }
        .logo-container {
            height: 80px; /* Set height */
            width: 120px; /* Set width */
            border: 2px solid #ccc; /* Optional: Border color */
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Ensures no overflow */
            margin-right: 1.5rem; /* Space between logo and name */
            border-radius: 0.375rem; /* Rounded corners */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Soft shadow */
        }
        .logo-container img {
            height: 100%; /* Full height */
            width: 100%; /* Full width */
            object-fit: contain; /* Ensure the full image is visible */
            max-width: 100%; /* Prevents scaling beyond container */
            max-height: 100%; /* Prevents scaling beyond container */
        }
        .info-container {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 1rem; /* Space above info container */
        }
        .info-container h2 {
            border-bottom: 2px solid #3b82f6; /* Blue underline for heading */
            padding-bottom: 0.5rem; /* Space under heading */
            color: #3b82f6; /* Blue heading */
            font-size: 1.5rem; /* Larger heading size */
        }
        .info-container p {
            margin: 0.5rem 0; /* Add margin for spacing */
            color: #333; /* Darker text color */
        }
        .info-container p:nth-child(2) { 
            background-color: #e0f2fe; /* Light blue background for street address */
            padding: 0.5rem; /* Padding for readability */
            border-radius: 0.375rem; /* Rounded corners */
        }
        /* Styling for contact details */
        .contact-details {
            margin-top: 1rem; /* Space above contact details */
            padding: 1rem; /* Padding for readability */
            background-color: #f8fafc; /* Light gray background */
            border-radius: 0.375rem; /* Rounded corners */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Soft shadow */
        }
        .contact-details p {
            font-weight: bold; /* Bold for better emphasis */
        }
        /* Button styles */
        .submit-button {
            background-color: #3b82f6; /* blue */
            color: white; /* white text */
            padding: 0.5rem 1rem; /* Padding for button */
            border-radius: 0.375rem; /* Rounded corners */
            transition: background-color 0.3s ease-in-out;
            cursor: pointer; /* Pointer cursor */
        }
        .submit-button:hover {
            background-color: #2563eb; /* darker blue */
        }
        /* Styles for the iframe */
        .iframe-container {
            margin-left: 2rem; /* Space between profile and iframe */
            flex: 1; /* Allow iframe to fill remaining space */
            border-radius: 0.5rem; /* Rounded corners */
            overflow: hidden; /* Ensure no overflow */
        }
        iframe {
            width: 100%; /* Full width */
            height: 600px; /* Fixed height */
            border: none; /* No border */
            border-radius: 0.5rem; /* Rounded corners */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Soft shadow */
        }
        .flex-container {
            display: flex; /* Flexbox for layout */
            justify-content: space-between; /* Space between elements */
        }
    </style>
</head>
<body class="bg-gray-50">
    {% include 'header.html' %}
    <div class="flex justify-center mt-10">
        <div class="form-container w-full max-w-3xl flex-container">
            <div>
                <div class="profile-header">
                    <div class="logo-container">
                        <img id="institution-logo" src="" alt="Institution Logo" />
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800" id="institution-name"></h1>
                </div>
                <div class="info-container">
                    <h2 class="text-lg font-semibold">Institution Details</h2>
                    <p>Street Address:</p>
                    <p id="address"></p>
                    <br/>
                    <div class="contact-details">
                        <p>Contact Details</p>
                        <p>Email: <span id="email"></span></p>
                        <p>Office: <span id="phone"></span></p>
                        <p>Website: <span id="website"></span></p>
                    </div>
                </div>
            </div>
            <div class="iframe-container">
                <iframe id="institution-website" src="" title="Institution Website" sandbox="allow-same-origin allow-scripts"></iframe>
            </div>
        </div>
    </div>
    <footer class="border-t-2 bg-[#0eabb0] text-gray-100 px-4 py-2 w-full">
        <p class="text-center">
            All rights reserved by Financial Reporting Council Bangladesh
        </p>
      </footer>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch("{% static 'institution.json' %}")
            .then(response => response.json())
            .then(data => {
                const instituteName = data.Institute_name;
                const formattedName = instituteName.replace(/\s+/g, ' ').trim(); // Keep single spaces
                const logoPath = `{% static '' %}${formattedName}.png`; // Construct logo path

                document.getElementById('institution-logo').src = logoPath; // Set logo source
                document.getElementById('institution-name').textContent = instituteName; // Set institution name
                document.getElementById('address').innerHTML = data.address.replace(/,/g, '<br />');
                document.getElementById('email').textContent = data.email;
                document.getElementById('phone').textContent = data.phone;
                document.getElementById('website').textContent = data.website;

                // Set the institution's website URL in the iframe
                const websiteURL = data.website.startsWith('http') ? data.website : 'http://' + data.website; // Ensure it starts with http:// or https://
                document.getElementById('institution-website').src = websiteURL; // Load the website into the iframe

                // Check if the website loads successfully
                fetch(websiteURL, { method: 'HEAD' })
                    .then(response => {
                        if (!response.ok) {
                            // If not ok, show a fallback link
                            const fallbackLink = document.createElement('a');
                            fallbackLink.href = websiteURL;
                            fallbackLink.target = '_blank';
                            fallbackLink.textContent = "Visit FRC Website";
                            fallbackLink.className = "text-blue-500 hover:underline"; // Tailwind CSS styles
                            document.querySelector('.info-container').appendChild(fallbackLink);
                        }
                    })
                    .catch(error => {
                        console.error('Error checking website:', error);
                        // Show a fallback link if there's an error
                        const fallbackLink = document.createElement('a');
                        fallbackLink.href = websiteURL;
                        fallbackLink.target = '_blank';
                        fallbackLink.textContent = "Visit FRC Website";
                        fallbackLink.className = "text-blue-500 hover:underline"; // Tailwind CSS styles
                        document.querySelector('.info-container').appendChild(fallbackLink);
                    });
            })
            .catch(error => console.error('Error fetching institution data:', error));
    });
</script>

</html>
